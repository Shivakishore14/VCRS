<html>
	<head>
		<link rel="stylesheet" href="css/bootstrap.min.css"/>
		<link rel="stylesheet" href="css/bootstrap-theme.css"/>
		<script src="js/jquery.js"></script>
		<script src="js/bootstrap.min.js" type="text/javascript"></script>
		<script src="js/bspage.js"></script>
		<script src="js/script.js"></script>
	</head>
	<body>
		<div id="top">
			<span id="logo">V.C.R.S</span>
		</div>
		<div id="test"></div>
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-3 col-md-3" id="panel">
					<br>
					<div class="panel panel-primary">
  						<!-- Default panel contents -->
 						<div class="panel-heading " id="testHead"><b>Tests Available</b></div>
  					
						<div class="list-group" id="listTest">
  							<button type="button" class="list-group-item">Test</button>
  							<button type="button" class="list-group-item">Test2</button>
  							<button type="button" class="list-group-item">Test3</button>
  							<button type="button" class="list-group-item">Test4</button>
  							<button type="button" class="list-group-item">Chemistry</button>
						</div>
					</div>
				</div>
				<div class="col-lg-9 col-md-9">
					<h2> Test Responses</h2>
					<table class="table table-striped table-bordered" id="tresult">
					</table>
				</div>
			</div>
		</div>
	</body>
	<style>
		#panel{
			background-color:#fff;
		}
		#test{ 
			position: absolute;
			width: 100%;
			height: 100%;
			background-color:aqua;
		}
		#top{
			height:50px;
			background-color:#00AE6D;
			padding-left:5%;
			color: #fff;
			font-size: 30px;
			font-weight: bold;
		}
		.table td {
			text-align: center;   
		}
	</style>
	<script>
		TestName = "sampleTest1"
		var th = $("#test").height();
		$("#test").hide();
		$("#imageAnswer").hide();
		$("#panel").height(th);
		//checkTest();
		function checkTest(){
			var obj = {};
			obj.testName = "sampleTest1";
			obj.sid = "6";
			obj.ans = ["option3","option1","option1","option4"]

			var json = JSON.stringify(obj);
			alert(json)
			$.post('saveResponse/', { response:json }, function(result) {
				alert(result);
			});
		}
		
		$.post('getData/', { getTest:"yes" }, function(result) {
    			var jsonData = JSON.parse(result);
			s = "";
			for (var i = 0; i < jsonData.length; i++) {
    			//	console.log(counter.counter_name);
				s = s + '<button type="button" class="list-group-item" name="'+jsonData[i].name+'" onclick="testClicked(this)">'+ jsonData[i].name +' <span class="badge">'+jsonData[i].no +'</span></button>';
				//alert(jsonData[i].name);
			}	
			$("#listTest").html(s);
		});
		function processJson(json) {
			//alert(json);
			obj = JSON.parse(json);
			s="";
			for (i in obj) {
				s = s + "<tr> <td> "+ obj[i].sid + "</td>";
				for (j in obj[i].ans) {
					s = s + "<td> " + obj[i].ans[j] +"</td>";
				}
				s = s + "<td></td></tr>";
			}
			$("#tresult").html(s);
		}
		function checkAns(){
			var a = $("tr");
			var l = a[0].cells.length;
			color = "white";
			for (var i = 1 ; i < a.length  ; i++) {
				correct = 0 ;
				for ( var j = 1; j < l; j++) {
					//alert(i);
					if (j == l - 1) {
						a[i].cells[j].innerHTML = correct;
					} else { 
						var ans1 = (a[i].cells[j].innerHTML).trim();
						var ans2 = (a[0].cells[j].innerHTML).trim();
						//alert(ans2);
						if(ans1 == ans2){
							color = "green";
							correct = correct + 1;					
						}else {
							color = "red";
						}
						a[i].cells[j].style.color = color;
					}
				} 
			}
		}
		function testClicked(a) {
			TestName = a.getAttribute("name");
			$.post('showResult/',{testName:TestName}, function(result) {
			
				processJson(result);
				//
				$.post('getData/', { testName:TestName }, function(result) {
					var a = JSON.parse(result);
					s = "<thead><tr><td>sid\\ans</td>";
					for (i in a ) {
						s = s + "<td>"+a[i]+"</td>";
					}
					s = s + "<td>Correct Answers</td></tr></thead>";
					a = $("#tresult").html();
					$("#tresult").html(s+a);
					checkAns();
				});		
			});
			
		}

		
	</script>
	
</html>
